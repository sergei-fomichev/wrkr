<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
	<meta name="google-signin-client_id" content="1008213894257-b98bdee3g0bklck0dm0q1t6umdvkegft.apps.googleusercontent.com">
    <link rel="icon" href="../../favicon.ico">
	 <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">

    <title>WRKR - Welcome</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">
	
    <!-- Custom styles -->
   <style>
  	 body {
    	 padding-top: 50px;
   	}
  	 .starter-template {
		 padding: 40px 15px;
   	  	text-align: center;
  	 }
	 .navbar{
		 background-color: #6520c7;
	 }
	 .navibar li a{
		 color: white !important;
	 }
	 .navbar-brand{
	 	color: white !important;
	 }
	 .navbar-right{
	 	margin: 7px 10px;
		color: white;
	 }
     #customBtn {
        display: inline-block;
        color: white;
      }
      #customBtn:hover {
        cursor: pointer;
      }
	  #signout{
		  height: 35px;
		  font-size: 13px;
		  vertical-align: middle;
		  line-height: 33px;
		  width: 65px;
	  }
	  .btn-primary{
		  background-color: #6520c7;
	  }
	  .stat{
		  margin: 0 auto;
		  display: block;
	  }
   </style>

  </head>

  <body>

    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">WRKR</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navibar">
            <li class="active"><a href="#">HOME</a></li>
            <li><a href="#about">ABOUT</a></li>
            <li><a href="#contact">DOWNLOAD</a></li>
          </ul>
		   <div onclick="signOut();" id="signout" class="navbar-right abcRioButton abcRioButtonBlue" style="display: none;">Sign out</div>
		 <div id="gSignInWrapper" class="navbar-right">
		    <div id="my-signin2"></div>
		 </div>
		<div>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
		<div class="page-header">
			<h1>Welcome to workout, <span id="given-name"></span></h1>
			<p class="lead">Wrkr is a collaborative effort between a user's smart phone, smart watch, and PC with Leap Motion connected with our website to help prevent a vast majority of onset wrist problems such as arthritis.</p>
		</div>
		<div class="row">
			<div class="col-sm-6 col-md-4">
				<div class="thumbnail">
					<img src="img/leapmotion.jpg" alt="">
					<div class="caption">
						<h3>Hand-wrist exerciser</h3>
						<p>You have <span class="alert-warning" id="ex-requested">0</span> exercise past due</p>
						<p><a href="#" class="btn btn-primary" role="button">Start exercising</a> <a href="#" class="btn btn-default" role="button">Button</a></p>
					</div>
				</div>
			</div>
			<div class="col-sm-6 col-md-4">
				<div class="thumbnail">
					<svg xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" width="200" height="200" class="stat">
					  <g class="score-canvas">
					    <circle cx="100" cy="100" r="100" fill="#2d41f5" ></circle>
					  </g>
					</svg>
					<div class="caption">
						<h3>Your score</h3>
						<p>Do the exercises on time to improve your score.</p>
						<p><a href="#" class="btn btn-primary" role="button">Got it!</a> <a href="#" class="btn btn-default" role="button">Button</a></p>
					</div>
				</div>
			</div>
			<div class="col-sm-6 col-md-4">
				<div class="thumbnail">
					<img src="" alt="" class="user-image">
					<div class="caption">
						<h3>Statistic</h3>
						<p>...</p>
						<p><a href="#" class="btn btn-primary" role="button">Watch a detailed stat</a> <a href="#" class="btn btn-default" role="button">Button</a></p>
					</div>
				</div>
			</div>
		</div>
     

    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/vendor/jquery.min.js"><\/script>')</script>
    <script src="js/bootstrap.min.js"></script>
	<script src="https://apis.google.com/js/platform.js?onload=renderButton" async defer></script>
	<script>
	//1008213894257-b98bdee3g0bklck0dm0q1t6umdvkegft.apps.googleusercontent.com
    function onSuccess(googleUser) {
		 $("#signout").show();
		 $("#given-name").text(googleUser.getBasicProfile().getGivenName());
		 //$(".user-image").attr( "src", function() {
		  // return googleUser.getBasicProfile().getImageUrl();
		// });
		 get_status(googleUser);
       }
       function onFailure(googleUser) {
         console.log(error);
       }
       function renderButton() {
         gapi.signin2.render('my-signin2', {
           'scope': 'profile email',
           'width': 200,
           'height': 35,
           'longtitle': false,
           'theme': 'dark',
           'onsuccess': onSuccess,
           'onfailure': onFailure
         });
       }
    function signOut() {
      var auth2 = gapi.auth2.getAuthInstance();
      auth2.signOut().then(function () {
        console.log('User signed out.');
		 $("#signout").hide();
      });
    }
	
	function get_status(googleUser){
		$.when(
			$.ajax({
				method: "GET",
				async: false,
			  url: "http://weblab.cs.uml.edu/~sfomiche/wrkr/api/api.php",
			  data: { exist: "", email: googleUser.getBasicProfile().getEmail() },
			  dataType: "json"
			})
			.done(function( msg ) {
				userId = msg.id;
				userScore = msg.karma;
			}))
			.then(function(msg){
				$.ajax({
				  method: "GET",
					sync: false,
				  url: "http://weblab.cs.uml.edu/~sfomiche/wrkr/api/api.php",
				  data: { exercises: "", id: userId},
				  dataType: "json"
				})
				.done(function( msg ) {
					//console.log(msg.exercises);
					$("#ex-requested").text(msg.exercises);
					$(".score-canvas").append("<text x='73' y='120' font-size='58' font-family='Veranda' fill='white'>"+userScore+"</text>");
					$(".stat").html($(".stat").html());
				})
	  });
	}
	
	var exNum = 0;
	var userId;
	var userScore;
/*
     function attachSignin(element) {
       console.log(element.id);
       auth2.attachClickHandler(element, {},
           function(googleUser) {
             document.getElementById('gSignInWrapper').innerText = "Signed in: " +
                 googleUser.getBasicProfile().getName();
           }, function(error) {
             alert(JSON.stringify(error, undefined, 2));
           });
     }
	 startApp();
	*/
	</script>
  </body>
</html>

